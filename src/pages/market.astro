---
import Layout from "@layouts/MainLayout.astro";
import Category from "@components/solid/Category.tsx";
import { initSwell } from "../lib/swell";

const runtime = Astro.locals.runtime;
const swell = initSwell(
  runtime
    ? runtime.env.PUBLIC_SWELL_STORE_ID
    : import.meta.env.PUBLIC_SWELL_STORE_ID,
  runtime
    ? runtime.env.PUBLIC_SWELL_PUBLIC_KEY
    : import.meta.env.PUBLIC_SWELL_PUBLIC_KEY,
);
const categories = await swell.categories.list({
  limit: 100,
  page: 1,
});

let products = await swell.products.list({
  limit: 9,
  page: 1,
});
---

<Layout
  title="Shopping page"
  description="Delivered farm fresh to you"
  categories={categories.results}
>
  <Category
    currentCollection={null}
    products={products.results}
    collections={categories.results}
  />
</Layout>
